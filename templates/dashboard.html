{% extends 'base.html' %}
{% block contenido %}
<div class="container py-4">
  <h2 class="text-center mb-4">ğŸ“Š Panel Principal â€” MR FUM</h2>

  <!-- âš¡ Accesos rÃ¡pidos -->
  <div class="d-flex justify-content-center gap-3 mb-4 flex-wrap">
    
    <a href="{{ url_for('productores.nuevo_productor') }}" class="btn btn-success btn-lg">ğŸ§‘â€ğŸŒ¾ Nuevo Productor</a>
    <a href="{{ url_for('ordenes.seleccionar_productor') }}" class="btn btn-primary btn-lg">ğŸ§ª Nueva Orden de Trabajo</a>
    <a href="{{ url_for('facturacion.nueva_ot') }}" class="btn btn-warning btn-lg">ğŸ’° Nueva O.T. FacturaciÃ³n</a>
  </div>

  <!-- ğŸ“Š MÃ©tricas -->
  <div class="row text-center mb-4">
    <div class="col-md-3"><div class="card shadow-sm"><div class="card-body"><h5>ğŸŒ¾ HectÃ¡reas Totales</h5><p class="fs-4">{{ total_hectareas }}</p></div></div></div>
    <div class="col-md-3"><div class="card shadow-sm"><div class="card-body"><h5>ğŸ—“ï¸ Productores Activos</h5><p class="fs-4">{{ productores_activos }}</p></div></div></div>
    <div class="col-md-3"><div class="card shadow-sm"><div class="card-body"><h5>â³ OT Pendientes</h5><p class="fs-4">{{ ot_pendientes }}</p></div></div></div>
    <div class="col-md-3"><div class="card shadow-sm"><div class="card-body"><h5>âœ… OT Completadas</h5><p class="fs-4">{{ ot_completadas }}</p></div></div></div>
  </div>

  <!-- ğŸ“… Filtro por periodo -->
  <form method="GET" class="row mb-4">
    <div class="col-md-4">
      <label>Desde</label>
      <input type="date" name="desde" class="form-control" value="{{ desde }}">
    </div>
    <div class="col-md-4">
      <label>Hasta</label>
      <input type="date" name="hasta" class="form-control" value="{{ hasta }}">
    </div>
    <div class="col-md-4 d-flex align-items-end">
      <button type="submit" class="btn btn-outline-secondary w-100">ğŸ” Buscar</button>
    </div>
  </form>

  <!-- ğŸ“‹ Ã“rdenes recientes -->
  <h5 class="mb-3">ğŸ“‹ Ã“rdenes Recientes</h5>
  <table class="table table-striped table-hover">
    <thead class="table-light">
      <tr>
        <th>NÃºmero</th>
        <th>Productor</th>
        <th>Fecha Trabajo</th>
        <th>HectÃ¡reas</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for ot in ordenes %}
      <tr>
        <td>OT-{{ ot.fecha.year }}-{{ '%04d' % ot.id }}</td>
        <td>{{ ot.productor.nombre }}</td>
        <td>{{ ot.fecha.strftime('%d/%m/%Y') }}</td>
        <td>{{ ot.hectareas }}</td>
        <td>{{ ot.estado.capitalize() }}</td>
        <td>
          <a href="{{ url_for('ordenes.ver_ot', ot_id=ot.id) }}" class="btn btn-sm btn-info">ğŸ‘ï¸</a>
          <a href="{{ url_for('ordenes.exportar_ot_pdf', ot_id=ot.id) }}" class="btn btn-sm btn-outline-dark">ğŸ“„ PDF</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
