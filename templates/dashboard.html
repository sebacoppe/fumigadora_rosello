{% extends 'base.html' %}
{% block contenido %}
<div class="container py-4">
  <h2 class="text-center mb-4">ğŸ“Š Panel Principal â€” MR FUM</h2>

  <!-- âš¡ Accesos rÃ¡pidos -->
  <div class="d-grid gap-3 mb-4">
    <a href="{{ url_for('productores.nuevo_productor') }}" class="btn btn-success btn-lg w-100">ğŸ§‘â€ğŸŒ¾ Nuevo Productor</a>
    <a href="{{ url_for('ordenes.seleccionar_productor') }}" class="btn btn-primary btn-lg w-100">ğŸ§ª Nueva Orden de Trabajo</a>
    <a href="{{ url_for('facturacion.nueva_ot') }}" class="btn btn-warning btn-lg w-100">ğŸ’° Nueva O.T. FacturaciÃ³n</a>
  </div>

  <!-- ğŸ“Š MÃ©tricas -->
  <div class="row text-center mb-4">
    <div class="col-12 col-md-3 mb-3">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5>ğŸŒ¾ HectÃ¡reas Totales</h5>
          <p class="fs-4">{{ total_hectareas }}</p>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-3 mb-3">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5>ğŸ—“ï¸ Productores Activos</h5>
          <p class="fs-4">{{ productores_activos }}</p>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-3 mb-3">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5>â³ OT Pendientes</h5>
          <p class="fs-4">{{ ot_pendientes }}</p>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-3 mb-3">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5>âœ… OT Completadas</h5>
          <p class="fs-4">{{ ot_completadas }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- ğŸ“… Filtro por periodo -->
  <form method="GET" class="row mb-4 g-3">
    <div class="col-12 col-md-4">
      <label>Desde</label>
      <input type="date" name="desde" class="form-control form-control-lg" value="{{ desde }}">
    </div>
    <div class="col-12 col-md-4">
      <label>Hasta</label>
      <input type="date" name="hasta" class="form-control form-control-lg" value="{{ hasta }}">
    </div>
    <div class="col-12 col-md-4 d-grid align-items-end">
      <button type="submit" class="btn btn-outline-secondary btn-lg">ğŸ” Buscar</button>
    </div>
  </form>

  <!-- ğŸ“‹ Ã“rdenes recientes -->
  <h5 class="mb-3">ğŸ“‹ Ã“rdenes Recientes</h5>
  <div class="table-responsive">
    <table class="table table-striped table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th>NÃºmero</th>
          <th>Productor</th>
          <th>Fecha Trabajo</th>
          <th>HectÃ¡reas</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for ot in ordenes %}
        <tr>
          <td>OT-{{ ot.fecha.year }}-{{ '%04d' % ot.id }}</td>
          <td>{{ ot.productor.nombre }}</td>
          <td>{{ ot.fecha.strftime('%d/%m/%Y') }}</td>
          <td>{{ ot.hectareas }}</td>
          <td>{{ ot.estado.capitalize() }}</td>
          <td class="d-grid gap-2">
            <a href="{{ url_for('ordenes.ver_ot', ot_id=ot.id) }}" class="btn btn-info btn-sm">ğŸ‘ï¸</a>
            <a href="{{ url_for('ordenes.exportar_ot_pdf', ot_id=ot.id) }}" class="btn btn-outline-dark btn-sm">ğŸ“„ PDF</a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
